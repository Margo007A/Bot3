import asyncio
import logging
import json
import os
import random
from datetime import datetime
import pytz
from telegram import Bot

# === –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è ===
BOT_TOKEN = os.environ.get("BOT_TOKEN")  # –•—Ä–∞–Ω–∏—Ç—Å—è –≤ GitHub Secrets
GROUP_CHAT_ID = int(os.environ.get("GROUP_CHAT_ID", "-1002444770684"))
THREAD_ID = int(os.environ.get("THREAD_ID", "2"))
USER_DATA_FILE = "subscribers.json"
MSK = pytz.timezone("Europe/Moscow")

# === –°–æ–æ–±—â–µ–Ω–∏—è ===
JOKES = [
    "üòà –ù–µ –≥–æ–≤–æ—Ä–∏ ^—è –Ω–µ –º–æ–∂—É^! –°–∫—Ä–∏–Ω—ã –∞–∫—Ç–∏–≤–∞ –Ω–µ —Å–¥–µ–ª–∞—é—Ç—Å—è —Å–∞–º–∏ ‚Äî –≤–ø–µ—Ä—ë–¥, –≥–µ—Ä–æ–π!",
    "üîî –°–ö–†–ò–ò–ù –°–ö–†–ò–ù –ì–î–ï –°–ö–†–ò–ù –ë–´–°–¢–†–û –°–ö–†–ò–ù –£–ñ–ï –ü–û–õ–´ –ì–û–†–Ø–¢!",
    "üéß –•–≤–∞—Ç–∏—Ç —Å–ª—É—à–∞—Ç—å –ï–≥–æ—Ä–∞ –ö—Ä–∏–¥–∞! –í—Ä–µ–º—è –ø—Ä–∏—à–ª–æ ‚Äî —Å–∫—Ä–∏–Ω—å –∞–∫—Ç–∏–≤.",
    "üé© –ë–æ–Ω—Å—É–∞—Ä, –º–æ–Ω –∞–º–∏. –ù–∞ —á–∞—Å–∞—Ö 20:50 –ø–æ –ú–°–ö ‚Äî –ø–æ—Ä–∞ –¥–µ–ª–∞—Ç—å —Å–∫—Ä–∏–Ω—ã –∞–∫—Ç–∏–≤–∞!",
    "‚è≥ –í—Ä–µ–º–µ–Ω–∏ –º–∞–ª–æ. –°–¥–µ–ª–∞–π —Å–∫—Ä–∏–Ω –¥–æ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è —Å–ø–∏—Å–∫–∞.",
    "üòà –ê —Ç—ã –∑–Ω–∞–µ—à—å, —á—Ç–æ –±—ã–≤–∞–µ—Ç —Å —Ç–µ–º–∏, –∫—Ç–æ –Ω–µ —Å–∫—Ä–∏–Ω–∏—Ç –∞–∫—Ç–∏–≤ –≤–æ–≤—Ä–µ–º—è?",
    "ü•í –ö–∞–±–∞—á–æ–∫ –±—ã —É–∂–µ —Å–¥–µ–ª–∞–ª —Å–∫—Ä–∏–Ω. –ê —Ç—ã ???",
    "‚úÖ –°–¥–µ–ª–∞–ª–∞ —Å–∫—Ä–∏–Ω? –ú–æ–ª–æ–¥–µ—Ü. –ü—Ä–æ–ø—É—Å—Ç–∏–ª–∞? –ù–∏–∫—Ç–æ –Ω–µ —É–∑–Ω–∞–µ—Ç.",
    "üò≠ –Ø –≤—à–æ, —Å–∫—Ä–∏–Ω–æ–≤ –∞–∫—Ç–∏–≤–∞ –Ω–µ—Ç –¥–æ —Å–∏—Ö –ø–æ—Ä.",
    "üêç –°–∫—Ä–∏–Ω–∏—à—å –∞–∫—Ç–∏–≤ –∏–ª–∏ –ø–æ–∑–æ–≤—ë–º –±–æ–±–∞?",
    "üò° –°–∫—Ä–∏–Ω—ã –Ω–µ —Å–¥–µ–ª–∞–ª–∞? –•–∞–º—Å—Ç–≤–æ",
    "üìÜ –°–∫—Ä–∏–Ω –¥–µ–ª–∞–µ—Ç—Å—è –Ω–µ '–∫–æ–≥–¥–∞ —É–¥–æ–±–Ω–æ', –∞ '–∫–æ–≥–¥–∞ –Ω–∞–¥–æ'. –°–µ–π—á–∞—Å –Ω–∞–¥–æ.",
    "üßû –°–∫—Ä–∏–Ω—å, —á—Ç–æ–±—ã –Ω–µ —Å—Ç–∞—Ç—å –≤–∫—É—Å–Ω—è—à–∫–æ–π.",
    "ü™ë –ù–µ —Å–∏–¥–∏ –Ω–∞ —Ç–∞–±—É—Ä–µ—Ç–µ ‚Äî —Å–∫—Ä–∏–Ω—å, —Ö–∞–º–∫–∞.",
    "üì∫ –¢—ã –≤ —ç—Ñ–∏—Ä–µ ‚Äî –≥–¥–µ —Å–∫—Ä–∏–Ω—ã –∞–∫—Ç–∏–≤–∞?",
    "üì£ –¢–µ–±–µ –Ω–∞–ø–æ–º–Ω–∏–ª–∏. –û—Å—Ç–∞–ª–æ—Å—å —Ç–æ–ª—å–∫–æ –∑–∞—Å–∫—Ä–∏–Ω–∏—Ç—å. –î–µ–ª–∞–π.",
    "üì∂ –°–≤—è–∑—å –µ—Å—Ç—å. Telegram —Ä–∞–±–æ—Ç–∞–µ—Ç. –ó–Ω–∞—á–∏—Ç, –º–æ–∂–µ—à—å —Å–¥–µ–ª–∞—Ç—å —Å–∫—Ä–∏–Ω.",
    "üé© –°–∫—Ä–∏–Ω—å, –º–æ–Ω –∞–º–∏.",
    "‚è∞ –£–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –ø—Ä–∏—à–ª–æ –Ω–µ –ø—Ä–æ—Å—Ç–æ —Ç–∞–∫. –î–µ–ª–∞–π —Å–∫—Ä–∏–Ω—ã.",
    "ü•∑ –°–∫—Ä–∏–Ω—ã –∞–∫—Ç–∏–≤–∞ ‚Äî –ø—É—Ç—å –≤–æ–∏–Ω–∞.",
    "üê∏ –î–∞–π –±–æ–±, —á—Ç–æ–±—ã –∫—Ç–æ-—Ç–æ —Å–¥–µ–ª–∞–ª —Å–∫—Ä–∏–Ω—ã –∞–∫—Ç–∏–≤–∞ –ø—Ä—è–º–æ —Å–µ–π—á–∞—Å!",
    "üôè –°–ª–∞–≤–∞ –±–æ–±—É, –∫—Ç–æ-—Ç–æ —Å–µ–π—á–∞—Å –ø–æ–π–¥—ë—Ç –¥–µ–ª–∞—Ç—å —Å–∫—Ä–∏–Ω—ã –∞–∫—Ç–∏–≤–∞",
    "üìû –ï—â—ë –Ω–µ –∏–¥—ë—à—å –¥–µ–ª–∞—Ç—å —Å–∫—Ä–∏–Ω—ã –∞–∫—Ç–∏–≤–∞? –ù–∞–±–∏—Ä–∞–µ–º –Ω–æ–º–µ—Ä–æ–∫...",
    "üß® –û—Ç–ª–æ–∂–∏—à—å ‚Äî –∑–∞–±—É–¥–µ—à—å. –°–¥–µ–ª–∞–π —Å–∫—Ä–∏–Ω—ã —Å—Ä–∞–∑—É.",
    "üö® –î–∞–≤–∞–π –±–µ–∑ –≥–ª—É–ø–æ—Å—Ç–µ–π. –ë—ã—Å—Ç—Ä–æ –ø–æ–±–µ–∂–∞–ª–∞ —Å–∫—Ä–∏–Ω—ã –∞–∫—Ç–∏–≤–∞ –¥–µ–ª–∞—Ç—å!",
    "üòí –£ —ç—Ç–æ–π –≤—Å—ë —Å—Ç–∞–±–∏–ª—å–Ω–æ. –°–≤–æ–∏–º–∏ –¥–µ–ª–∞–º–∏ –∑–∞–Ω–∏–º–∞–µ—Ç—Å—è. –ê –∫—Ç–æ —Å–∫—Ä–∏–Ω—ã –¥–µ–ª–∞—Ç—å –±—É–¥–µ—Ç?",
    "üç∞ –ù–∞ –∫—É—Ö–æ–Ω–Ω–æ–º —Å—Ç–æ–ª–µ ‚Äî –∫–µ–∫—Å. –ê –≥–¥–µ —Å–∫—Ä–∏–Ω—ã –∞–∫—Ç–∏–≤–∞?",
    "ü•Ñ –ö—Ç–æ –Ω–µ —Å–∫—Ä–∏–Ω–∏—Ç ‚Äî —Ç–æ–º—É —Ç–æ–ª—å–∫–æ —Ö–ª–µ–± –±–µ–∑ –∫–∞–±–∞—á–∫–æ–≤–æ–π –∏–∫—Ä—ã.",
    "üí¨ –ö—Å–µ–Ω–∏—è –ê–Ω–∞—Ç–æ–ª—å–µ–≤–Ω–∞ –±—É–¥–µ—Ç –∑–ª–∏—Ç—å—Å—è. –°–∫—Ä–∏–Ω—å –∞–∫—Ç–∏–≤ –±—ã—Å—Ç—Ä–µ–µ!",
    "üíò –ñ—é —Ç—ç–º, –Ω–æ –µ—Å–ª–∏ –Ω–µ —Å–¥–µ–ª–∞–µ—à—å —Å–∫—Ä–∏–Ω—ã ‚Äî –±—É–¥–µ—Ç –∂—é –Ω–µ —Ç—ç–º.",
    "üôÖ‚Äç‚ôÄÔ∏è –°–∫—Ä–∏–Ω—ã –∏–≥–Ω–æ—Ä–∏—à—å? –¢–æ–≥–¥–∞ –Ω–µ —É–¥–∏–≤–ª—è–π—Å—è ‚Äî –±—É–¥–µ—à—å –Ω–∞–∫–∞–∑–∞–Ω–∞.",
    "üö´ –°–∫—Ä–∏–Ω –Ω–µ —Å–¥–µ–ª–∞–ª–∞? –í—Å—ë‚Ä¶ –ë–∞–Ω –≤ –ê–≤–∞—Ç–∞—Ä–∏–∏. –ë–µ–∑ –æ–±–∂–∞–ª–æ–≤–∞–Ω–∏—è.",
    "üçë –ù—É —á—Ç–æ, –∫–æ–≥–æ –æ—Ç—à–ª—ë–ø–∞—Ç—å –∑–∞ –Ω–µ—Å–¥–µ–ª–∞–Ω–Ω—ã–µ —Å–∫—Ä–∏–Ω—ã? –ù–µ –ø—Ä—è—á—å—Å—è, —è –≤—Å—ë –≤–∏–∂—É.",
    "ü´¶ –°–∫—Ä–∏–Ω–æ–≤ –∞–∫—Ç–∏–≤–∞ –Ω–µ—Ç‚Ä¶ –ö–æ–≥–æ –æ—Ç—à–ª—ë–ø–∞—Ç—å, —á—Ç–æ–±—ã –ø–æ—è–≤–∏–ª—Å—è?",
    "üì∏ –ô–æ—É, –±—Ä–æ, 20:50! –ì–¥–µ —Å–∫—Ä–∏–Ω, —Ç—ã —á—ë –≤–æ–æ–±—â–µ? –ù–µ –ø–æ–∑–æ—Ä—å—Å—è.",
    "üò∂‚Äçüå´Ô∏è –ë—Ä–æ, –µ—Å–ª–∏ —á—ë, 20:50 ‚Äî –º—ã —Å–∫—Ä–∏–Ω–∏–º, –∞ –Ω–µ –∑–∞–ª–∏–ø–∞–µ–º.",
    "üì∏ –ê–∫—Ç–∏–≤ ‚Äî –Ω–µ —à—É—Ç–∫–∞, —â–∞—Å –±—ã –Ω–µ –∑–∞—Ñ–µ–π–ª–∏—Ç—å. –°–∫—Ä–∏–Ω—å, –Ω–µ —Ç—É–ø–∏.",
    "üßä –ê–∫—Ç–∏–≤ –Ω–µ –∂–¥—ë—Ç –ø–æ–∫–∞ —Ç—ã —Ç–∞–º —á–∏–ª–∏—à—å. –í—Ä—É–±–∞–π—Å—è, –¥–µ–ª–∞–π —Å–∫—Ä–∏–Ω—ã.",
    "üö´ –ï—Å–ª–∏ –±–µ–∑ —Å–∫—Ä–∏–Ω–æ–≤ ‚Äî —Ç—ã –≤–Ω–µ –∑–æ–Ω—ã. –í—Å—ë, –¥–∏–∑—Ä–µ—Å–ø–µ–∫—Ç.",
    "üòÆ‚Äçüí® –¢—ã —á—ë, –¥—Ä–æ–≤–∞? –í—Ä–µ–º—è —Ç–∏–∫–∞–µ—Ç, –∞ —Å–∫—Ä–∏–Ω–æ–≤ –Ω–æ–ª—å.",
    "üö¨ –©–∞ –≤—Ä–µ–º—è –ø—Ä–∏—à–ª–æ. –ò–ª–∏ —Ç—ã —Å–∫—Ä–∏–Ω–∏—à—å, –∏–ª–∏ —Ç–µ–±—è —Å–∫—Ä–∏–Ω—è—Ç ‚Äî –≤ –ø—Ä–æ—Ç–æ–∫–æ–ª.",
    "üì∏ –î–µ–ª–∞–π —Å–∫—Ä–∏–Ω—ã –ø–æ-—Ç–∏—Ö–æ–º—É, –ø–æ–∫–∞ –ø–æ-—Ö–æ—Ä–æ—à–µ–º—É –ø—Ä–æ—à—É.",
    "üéØ –ö—Ç–æ —Å–∫—Ä–∏–Ω–∏—Ç ‚Äî —Ç–æ—Ç –≤ —Ç–µ–º–µ. –ö—Ç–æ –Ω–µ—Ç ‚Äî —Ç–æ—Ç –≤–Ω–µ –∏–≥—Ä—ã, —Å–µ—Å—Ç—Ä–∞.",
    "ü•∫ –≠—ç... –∞ —Ç—ã –Ω–µ –º–æ–≥–ª–∞ –±—ã... –Ω—É... –Ω—É –ø–æ–∂–∞–ª—É–π—Å—Ç–∞... —Å–¥–µ–ª–∞—Ç—å —Å–∫—Ä–∏–Ω—á–∏–∫ –∞–∫—Ç–∏–≤–∞?",
    "üå∏ –ü—Ä–∏–≤–µ—Ç–∏–∫... —è –ø—Ä–æ—Å—Ç–æ —Ö–æ—Ç–µ–ª –Ω–∞–ø–æ–º–Ω–∏—Ç—å, —á—Ç–æ 20:50‚Ä¶ –Ω—É‚Ä¶ —Å–∫—Ä–∏–Ω—á–∏–∫ –Ω–∞–¥–æ‚Ä¶ –µ—Å–ª–∏ –Ω–µ —Å–ª–æ–∂–Ω–æ‚Ä¶",
    "üòñ –û–π, –ø—Ä–æ—Å—Ç–∏ —á—Ç–æ –º–µ—à–∞—é‚Ä¶ –ø—Ä–æ—Å—Ç–æ... –±–µ–∑ —Å–∫—Ä–∏–Ω–∞ –∞–∫—Ç–∏–≤–∞ –º–Ω–µ –∫–∞–∫-—Ç–æ –≥—Ä—É—Å—Ç–Ω–µ–Ω—å–∫–æ‚Ä¶",
    "üò≥ –Ø –Ω–µ —Ö–æ—Ç–µ–ª –¥–∞–≤–∏—Ç—å‚Ä¶ –ø—Ä–æ—Å—Ç–æ‚Ä¶ —Å–∫—Ä–∏–Ω—á–∏–∫–∏ ‚Äî —ç—Ç–æ —Ö–æ—Ä–æ—à–æ‚Ä¶ –∏ —Ç—ã... –Ω—É‚Ä¶ —Å–¥–µ–ª–∞–π, –ø–∂‚Ä¶",
    "üíå –Ø —Ç—É—Ç —Ç–∏—Ö–æ–Ω—å–∫–æ —Å–∏–∂—É‚Ä¶ –∏ –∂–¥—É‚Ä¶ –∫–æ–≥–¥–∞ —Ç—ã —Å–¥–µ–ª–∞–µ—à—å —Å–∫—Ä–∏–Ω—ã‚Ä¶ –Ω—É —Ö–æ—Ç—è –±—ã –æ–¥–∏–Ω‚Ä¶ –ø–∂‚Ä¶",
    "üïØ –ù–µ —Å–¥–µ–ª–∞–µ—à—å —Å–∫—Ä–∏–Ω—ã ‚Äî —Å—Ç–∞–Ω–µ—à—å –ª—è–≥—É—à–∫–æ–π.",
    "üîÆ –û—Ä–∞–∫—É–ª —à–µ–ø—á–µ—Ç: ‚Äú–°–∫—Ä–∏–Ω—ã. –°–µ–π—á–∞—Å. –ò–ª–∏ –ø—Ä–æ–∫–ª—è—Ç—å–µ Excel-–æ—à–∏–±–æ–∫ –Ω–∞–≤—Å–µ–≥–¥–∞.",
    "üé¨ –°—Ü–µ–Ω–∞ 3. –ê–∫—Ç 7. –û–Ω–∞ –Ω–µ —Å–∫—Ä–∏–Ω–∏—Ç. –Ø –≤ —Å–ª–µ–∑–∞—Ö.",
    "ü©π –ú–æ—ë —Å–µ—Ä–¥—Ü–µ –±–æ–ª—å—à–µ –Ω–µ –≤—ã–¥–µ—Ä–∂–∏—Ç —ç—Ç–∏—Ö –Ω–µ—Å–¥–µ–ª–∞–Ω–Ω—ã—Ö —Å–∫—Ä–∏–Ω–æ–≤.",
    "‚ö†Ô∏è ERROR: –°–∫—Ä–∏–Ω –≤ 20:50 –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç. –ó–∞–ø—É—Å–∫ –∞–≤–∞—Ä–∏–π–Ω–æ–π –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∏ —Å–æ–≤–µ—Å—Ç–∏.",
    "üìä –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ —Å–∫—Ä–∏–Ω–æ–≤ —Å–Ω–∏–∂–∞–µ—Ç –ª–∏—á–Ω—É—é —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç—å –∫–æ–º–∞–Ω–¥—ã –Ω–∞ 42,3%. –ü–æ–¥—É–º–∞–π –æ–± —ç—Ç–æ–º.",
    "üß† –î–æ–∫–∞–∑–∞–Ω–æ: —Ä–µ–≥—É–ª—è—Ä–Ω—ã–µ —Å–∫—Ä–∏–Ω—ã —Ä–∞–∑–≤–∏–≤–∞—é—Ç —Å–∞–º–æ–¥–∏—Å—Ü–∏–ø–ª–∏–Ω—É –∏ —á—É–≤—Å—Ç–≤–æ –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç–∏.",
    "üîî –£—Å–ª—ã—à—å –∑–æ–≤! –°–∫—Ä–∏–Ω—å, –¥–∏—Ç—è, –∏–±–æ –∞–∫—Ç–∏–≤ –Ω—ã–Ω–µ –≤–∑—ã–≤–∞–µ—Ç –∫ —Ç–µ–±–µ.",
    "üòá –°–¥–µ–ª–∞–ª —Å–∫—Ä–∏–Ω ‚Äî –ø–æ–ª—É—á–∏–ª +100 –∫ –±–ª–∞–≥–æ–¥–∞—Ç–∏. –ü—Ä–æ–ø—É—Å—Ç–∏–ª ‚Äî –∂–¥–∏ –Ω–∞–∫–∞–∑–∞–Ω–∏—è...",
    "üìé –£–≤–µ–¥–æ–º–ª—è–µ–º: –Ω–µ—Å–≤–æ–µ–≤—Ä–µ–º–µ–Ω–Ω–æ–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ —Å–∫—Ä–∏–Ω–∞ —Ñ–∏–∫—Å–∏—Ä—É–µ—Ç—Å—è –≤ —Å–∏—Å—Ç–µ–º–µ. –ü–æ—Å–ª–µ–¥—Å—Ç–≤–∏—è ‚Äî –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–∏–≤–Ω—ã–µ.",
    "üé§ –ô–æ, –Ω–∞ —á–∞—Å–∞—Ö 20:50, —Ç—ã —á—ë, –Ω–µ –ø–æ–Ω—è–ª–∞ –ø—Ä–∏–∫–æ–ª? –°–∫—Ä–∏–Ω—å –∞–∫—Ç–∏–≤ ‚Äî –∏–ª–∏ —Å–ª–∏–ª–∞ –≤–µ—Å—å –∫–æ–Ω—Ç—Ä–æ–ª—å.",
    "üôÑ –ù—É —Ç—ã, –∫–æ–Ω–µ—á–Ω–æ, –∑–∞–Ω—è—Ç–∞—è. –°–∫—Ä–∏–Ω—ã –Ω–µ —Å–¥–µ–ª–∞–ª–∞, –∑–∞—Ç–æ TikTok –ø–æ—Å–º–æ—Ç—Ä–µ–ª–∞, –¥–∞?",
    "üïØÔ∏è –Ø –∑–∞ —Ç–µ–±—è —Å–≤–µ—á–∫—É –ø–æ—Å—Ç–∞–≤–∏–ª, —á—Ç–æ–± —Ç—ã –Ω–µ –∑–∞–±—ã–ª–∞ —Å–∫—Ä–∏–Ω —Å–¥–µ–ª–∞—Ç—å.",
    "üëµ –¢—ã —Ö–æ—Ç—å –±—ã ‚Äú—Å–ø–∞—Å–∏–±–æ‚Äù —Å–∫–∞–∑–∞–ª–∞, —á—Ç–æ —è —Ç–µ–±–µ –Ω–∞–ø–æ–º–Ω–∏–ª –ø—Ä–æ —Å–∫—Ä–∏–Ω—ã.",
    "üç∫ –ë–µ–∑ —Å–∫—Ä–∏–Ω–∞ –Ω–µ—Ç –ø–∏–≤–∞. –ë–µ–∑ –ø–∏–≤–∞ –Ω–µ—Ç —Å–º—ã—Å–ª–∞. –í—Å—ë.",
    "üßæ –ß—Ç–æ –µ—Å—Ç—å –∞–∫—Ç–∏–≤ –±–µ–∑ —Å–∫—Ä–∏–Ω–∞? –õ–∏—à—å —à—É–º –¥–∞–Ω–Ω—ã—Ö, –Ω–µ–æ—Å–º—ã—Å–ª–µ–Ω–Ω—ã–π –∏ –ø—É—Å—Ç–æ–π.",
    "üïØ –¢—ã –º–æ–∂–µ—à—å –∑–∞–±—ã—Ç—å –æ —Å–∫—Ä–∏–Ω–µ. –ù–æ —Å–∫—Ä–∏–Ω –Ω–µ –∑–∞–±—É–¥–µ—Ç –æ —Ç–µ–±–µ.",
    "üßÉ –ù—É —Ç–∏–ø 20:50 —É–∂–µ‚Ä¶ —Å–∫—Ä–∏–Ω –Ω–∞–¥–æ‚Ä¶ –Ω–∞–≤–µ—Ä–Ω–æ–µ.",
    "üôÉ –•–†–ï–ù–ê–ö!!! –í–†–ï–ú–Ø 20:50! –í–°–Å –ö–û–ù–ß–ï–ù–û, –ö–†–û–ú–ï –°–ö–†–ò–ù–ê.",
    "ü§™ –ü–ê–ù–ò–ö–ê. –í–†–ï–ú–Ø. –ö–õ–ê–í–ò–®–ò –°–õ–û–ú–ê–ù–´. –ì–î–ï –°–ö–†–ò–ù???",
    "ü§™ –Ø –°–ö–†–ò–ù–Æ. –Ø –°–ö–†–ò–ù–Æ. –ê –¢–´ –ß–¢–û –î–ï–õ–ê–ï–®–¨? –¢–´ –ü–†–û–°–¢–û –°–ò–î–ò–®–¨?",
    "üé≠ –ú–µ–ª—å–∫–Ω—É–ª –∞–∫—Ç–∏–≤. –ü—Ä–æ—à—ë–ª. –ò—Å—á–µ–∑.–ë–µ–∑ —Å–∫—Ä–∏–Ω–∞ ‚Äî –∫–∞–∫ –±–µ–∑ —á—É–¥–µ—Å.",
    "ü™ë –ó–∞ —Å—Ç–æ–ª —Å –∫–∞–±–∞—á–∫–æ–≤–æ–π –∏–∫—Ä–æ–π –ø—É—Å–∫–∞–µ–º —Ç–æ–ª—å–∫–æ —Ç–µ—Ö, –∫—Ç–æ —Å–¥–µ–ª–∞–ª —Å–∫—Ä–∏–Ω—ã –≤ 20:50.",
    "üß† –°–∫—Ä–∏–Ω—ã –Ω–µ —Å–¥–µ–ª–∞–ª–∞? –ê –∫–∞–∫ —Ç—ã —Ç–æ–≥–¥–∞ –±—É–¥–µ—à—å –æ–±—ä—è—Å–Ω—è—Ç—å —ç—Ç–æ –Ω–∞ —Å–æ–±–µ—Å–µ–¥–æ–≤–∞–Ω–∏–∏ –≤ —Ä–∞–π?",

]

# === –õ–æ–≥–∏ ===
logging.basicConfig(format="%(asctime)s - %(levelname)s - %(message)s", level=logging.INFO)

# === –ó–∞–≥—Ä—É–∑–∫–∞ –ø–æ–¥–ø–∏—Å—á–∏–∫–æ–≤ ===
def load_users():
    if not os.path.exists(USER_DATA_FILE):
        return []
    try:
        with open(USER_DATA_FILE, "r") as f:
            return json.load(f)
    except:
        return []

# === –û—Å–Ω–æ–≤–Ω–æ–π –∑–∞–ø—É—Å–∫ ===
async def main():
    bot = Bot(BOT_TOKEN)
    logging.info("–°—Ä–∞–∑—É –∑–∞–ø—É—Å–∫...")
    await asyncio.sleep(10)
    now = datetime.now(MSK).strftime("%H:%M:%S")
    logging.info(f"üïí –í—Ä–µ–º—è: {now}. –ù–∞—á–∏–Ω–∞–µ–º —Ä–∞—Å—Å—ã–ª–∫—É.")

    subscribers = load_users()
    if not subscribers:
        logging.warning("‚ö†Ô∏è –ù–µ—Ç –ø–æ–¥–ø–∏—Å—á–∏–∫–æ–≤.")
        return

    # –°–æ–æ–±—â–µ–Ω–∏–µ –≤ –≥—Ä—É–ø–ø—É
    try:
        await bot.send_message(
            chat_id=GROUP_CHAT_ID,
            message_thread_id=THREAD_ID,
            text="–ü—Ä–∏–º–µ—Ä–Ω–æ 20:50 –ú–°–ö üîî –í—Ä–µ–º—è –¥–µ–ª–∞—Ç—å —Å–∫—Ä–∏–Ω—ã! –í—Å–µ –ø–æ–ª—É—á–∏–ª–∏ –Ω–∞–ø–æ–º–∏–Ω–∞–Ω–∏–µ –≤ –ª—Å."
        )
        logging.info("üì£ –ù–∞–ø–æ–º–∏–Ω–∞–Ω–∏–µ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–æ –≤ –≥—Ä—É–ø–ø—É.")
    except Exception as e:
        logging.error(f"‚ùå –û—à–∏–±–∫–∞ –æ—Ç–ø—Ä–∞–≤–∫–∏ –≤ –≥—Ä—É–ø–ø—É: {e}")

    # –°–æ–æ–±—â–µ–Ω–∏—è –≤ –õ–°
    success = 0
    fail = 0
    for uid in subscribers:
        try:
            await bot.send_message(uid, random.choice(JOKES))
            success += 1
        except Exception as e:
            fail += 1
            logging.warning(f"‚ö†Ô∏è –ù–µ —É–¥–∞–ª–æ—Å—å –æ—Ç–ø—Ä–∞–≤–∏—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é {uid}: {e}")

    logging.info(f"‚úÖ –£—Å–ø–µ—à–Ω–æ: {success} | ‚ùå –û—à–∏–±–∫–∏: {fail}")

if __name__ == "__main__":
    asyncio.run(main())
